enable
conf t

hostname NG-1

!! MPLS !!

mpls ldp advertise-labels
mpls ldp router-id Loopback 0 force

!! VRF Telredor !!

ip vrf vrf-telredor
	rd 65000:1
	route-target both 65000:1

!! INTERFACES !!

interface Loopback 0
	!Identifiant
	ip address 172.16.128.1 255.255.255.255

interface Serial 0/0
	!Vers NG-2
	ip address 172.16.0.1 255.255.255.252
	no shutdown

interface Serial 0/1
	!Vers NG-3
	ip address 172.16.0.5 255.255.255.252
	no shutdown

!! ROUTAGE INTERNE !!

router ospf 1
	network 172.16.0.0 0.0.255.255 area 0

!! ROUTAGE TELREDOR !!

router ospf 2 vrf vrf-telredor
	network 10.0.0.0 0.255.255.255 area 0
	redistribute bgp 100 subnets

router bgp 100
	neighbor 172.16.128.2 remote-as 100
	neighbor 172.16.128.2 update-source Loopback 0
	neighbor 172.16.128.3 remote-as 100
	neighbor 172.16.128.3 update-source Loopback 0
	address-family vpnv4
		neighbor 172.16.128.2 activate
		neighbor 172.16.128.2 send-community both
		neighbor 172.16.128.3 activate
		neighbor 172.16.128.3 send-community both
	address-family ipv4 vrf vrf-telredor
		redistribute ospf 2 vrf vrf-telredor